\hypertarget{bluetooth__interface_8h}{}\doxysection{Core/\+Inc/bluetooth\+\_\+interface.h File Reference}
\label{bluetooth__interface_8h}\index{Core/Inc/bluetooth\_interface.h@{Core/Inc/bluetooth\_interface.h}}


Functions and makros related to interpreting and executing command received over Bluetooth~\newline
  


{\ttfamily \#include \char`\"{}stdio.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}RTC\+\_\+alarm.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}water\+\_\+pump.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}flags.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}sensors\+\_\+readings.\+h\char`\"{}}\newline
\doxysubsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\#define \mbox{\hyperlink{bluetooth__interface_8h_a8124d6861d899de89dd6ed62efd71f5b}{BLUETOOTH\+\_\+\+COMMAND\+\_\+\+SET\+\_\+\+TIME}}~\textquotesingle{}T\textquotesingle{}
\item 
\#define \mbox{\hyperlink{bluetooth__interface_8h_aeeed2f3fbc9cf1e8555dc2fda473509a}{BLUETOOTH\+\_\+\+COMMAND\+\_\+\+SET\+\_\+\+FREQ}}~\textquotesingle{}F\textquotesingle{}
\item 
\#define \mbox{\hyperlink{bluetooth__interface_8h_a798a6686eccdd143c359f1dfce8682a2}{BLUETOOTH\+\_\+\+COMMAND\+\_\+\+DATA\+\_\+\+REQUEST}}~\textquotesingle{}D\textquotesingle{}
\item 
\#define \mbox{\hyperlink{bluetooth__interface_8h_a00018ef97fe87a259e77ca74d28ce3f1}{BLUETOOTH\+\_\+\+COMMAND\+\_\+\+SET\+\_\+\+AMOUNT}}~\textquotesingle{}A\textquotesingle{}
\item 
\#define \mbox{\hyperlink{bluetooth__interface_8h_a238f817483a21aab491cfec0cf97465d}{BLUETOOTH\+\_\+\+COMMAND\+\_\+\+SEND\+\_\+\+DATA}}~\textquotesingle{}S\textquotesingle{}
\item 
\#define \mbox{\hyperlink{bluetooth__interface_8h_a97d901dfa0785ef552f0978ce19f05e6}{BLUETOOTH\+\_\+\+COMMAND\+\_\+\+FORCE\+\_\+\+WATERING}}~\textquotesingle{}P\textquotesingle{}
\item 
\#define \mbox{\hyperlink{bluetooth__interface_8h_aef66ce2d643ae78c1ab253cb54309c07}{BLUETOOTH\+\_\+\+COMMAND\+\_\+\+SEPARATOR}}~\textquotesingle{}/\textquotesingle{}
\item 
\#define \mbox{\hyperlink{bluetooth__interface_8h_a33f69cf115addac674c54ea9635d03e5}{BLUETOOTH\+\_\+\+COMMAND\+\_\+\+ERROR}}~0
\item 
\#define \mbox{\hyperlink{bluetooth__interface_8h_af814ff1fb37e1d4b7c3c04d877b799d2}{BLUETOOTH\+\_\+\+COMMAND\+\_\+\+OK}}~1
\end{DoxyCompactItemize}
\doxysubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
uint8\+\_\+t \mbox{\hyperlink{bluetooth__interface_8h_a498f92a1519445a2fd94181a6b5e5a68}{BLUETOOTH\+\_\+\+INTERFACE\+\_\+interpret\+\_\+command}} (char $\ast$command, \mbox{\hyperlink{struct_water___pump___struct}{Water\+\_\+\+Pump\+\_\+\+Struct}} $\ast$\mbox{\hyperlink{main_8c_a2649a4098c074e58183be8281e75b4a4}{pump}}, \mbox{\hyperlink{struct_flags___struct}{Flags\+\_\+\+Struct}} $\ast$\mbox{\hyperlink{main_8c_a710f2654bd0828d357e8439786d58a09}{flags}}, \mbox{\hyperlink{struct_a_l_a_r_m___r_t_c__struct}{ALARM\+\_\+\+RTC\+\_\+struct}} $\ast$\mbox{\hyperlink{main_8c_aea448f89c6b968930abf2ac62031add3}{alarm\+\_\+struct}})
\begin{DoxyCompactList}\small\item\em Function used to interpret command according to rules of custom protocol. \end{DoxyCompactList}\item 
uint8\+\_\+t \mbox{\hyperlink{bluetooth__interface_8h_a46a15cdb1a7e826ba0ef0a12f7cd82df}{BLUETOOTH\+\_\+\+INTERFACE\+\_\+send\+\_\+data}} (char $\ast$buffer, \mbox{\hyperlink{struct_sensor___readings___struct}{Sensor\+\_\+\+Readings\+\_\+\+Struct}} readings)
\begin{DoxyCompactList}\small\item\em Prepares command with sensor data according to rules of protocol. \end{DoxyCompactList}\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
Functions and makros related to interpreting and executing command received over Bluetooth~\newline
 

Command should follow specific format, explained below\+:~\newline
 In general command starts with capital letter indicating specific action followed, every meaningful information should be separated by \textquotesingle{}/\textquotesingle{}.~\newline
 Command list\+:~\newline
 Setting RTC time -\/ \char`\"{}\+T/\+HOURS/\+MINUTES/\+WEEKDAY/\char`\"{} For instance \char`\"{}\+T/9/59/3/\char`\"{} sets current time to 9\+:59 Wednesday.~\newline
 Setting days between measurements -\/ \char`\"{}\+F/\+HOUR\+\_\+\+OF\+\_\+\+MEASUREMENT/\+DAYS\+\_\+\+BETWEEN\+\_\+\+MEASUREMENTS/\char`\"{}. Only 1-\/7 day periods are allowed. For instance \char`\"{}\+F/12/2/\char`\"{} will perform automatic measurements every other day at 12 AM.~\newline
 Setting amount of time that pump should water the plant -\/ \char`\"{}\+A/\+AMOUNT/\char`\"{}.For instance \char`\"{}\+A/20/59/3/\char`\"{} will make pump turn on for 20s.~\newline
 Requesting data from sensors -\/ \char`\"{}\+D/\char`\"{} performs asynchronic measuremnet.\+For instance \char`\"{}\+D/\char`\"{} will start asynchronic measurement.~\newline
 Sending data -\/ Sending data form uc to Bluetooth device -\/ \char`\"{}\+S/\+SOIL\+\_\+\+MOISTURE/\+TEMPERTURE/\+AIR\+\_\+\+MOISTURE/\char`\"{} For instance \char`\"{}\+S/70/29/30/\char`\"{} means 70\% soil moisture, 29 Celcius degrees and 30\% air humidity.~\newline
 \begin{DoxyAuthor}{Author}
Pawe≈Ç Chalimoniuk 
\end{DoxyAuthor}


\doxysubsection{Macro Definition Documentation}
\mbox{\Hypertarget{bluetooth__interface_8h_a798a6686eccdd143c359f1dfce8682a2}\label{bluetooth__interface_8h_a798a6686eccdd143c359f1dfce8682a2}} 
\index{bluetooth\_interface.h@{bluetooth\_interface.h}!BLUETOOTH\_COMMAND\_DATA\_REQUEST@{BLUETOOTH\_COMMAND\_DATA\_REQUEST}}
\index{BLUETOOTH\_COMMAND\_DATA\_REQUEST@{BLUETOOTH\_COMMAND\_DATA\_REQUEST}!bluetooth\_interface.h@{bluetooth\_interface.h}}
\doxysubsubsection{\texorpdfstring{BLUETOOTH\_COMMAND\_DATA\_REQUEST}{BLUETOOTH\_COMMAND\_DATA\_REQUEST}}
{\footnotesize\ttfamily \#define BLUETOOTH\+\_\+\+COMMAND\+\_\+\+DATA\+\_\+\+REQUEST~\textquotesingle{}D\textquotesingle{}}

Makro in command indicating that user wants to receive current soil measurements. 

Definition at line 24 of file bluetooth\+\_\+interface.\+h.

\mbox{\Hypertarget{bluetooth__interface_8h_a33f69cf115addac674c54ea9635d03e5}\label{bluetooth__interface_8h_a33f69cf115addac674c54ea9635d03e5}} 
\index{bluetooth\_interface.h@{bluetooth\_interface.h}!BLUETOOTH\_COMMAND\_ERROR@{BLUETOOTH\_COMMAND\_ERROR}}
\index{BLUETOOTH\_COMMAND\_ERROR@{BLUETOOTH\_COMMAND\_ERROR}!bluetooth\_interface.h@{bluetooth\_interface.h}}
\doxysubsubsection{\texorpdfstring{BLUETOOTH\_COMMAND\_ERROR}{BLUETOOTH\_COMMAND\_ERROR}}
{\footnotesize\ttfamily \#define BLUETOOTH\+\_\+\+COMMAND\+\_\+\+ERROR~0}

Makro indicating setting time in command. 

Definition at line 29 of file bluetooth\+\_\+interface.\+h.

\mbox{\Hypertarget{bluetooth__interface_8h_a97d901dfa0785ef552f0978ce19f05e6}\label{bluetooth__interface_8h_a97d901dfa0785ef552f0978ce19f05e6}} 
\index{bluetooth\_interface.h@{bluetooth\_interface.h}!BLUETOOTH\_COMMAND\_FORCE\_WATERING@{BLUETOOTH\_COMMAND\_FORCE\_WATERING}}
\index{BLUETOOTH\_COMMAND\_FORCE\_WATERING@{BLUETOOTH\_COMMAND\_FORCE\_WATERING}!bluetooth\_interface.h@{bluetooth\_interface.h}}
\doxysubsubsection{\texorpdfstring{BLUETOOTH\_COMMAND\_FORCE\_WATERING}{BLUETOOTH\_COMMAND\_FORCE\_WATERING}}
{\footnotesize\ttfamily \#define BLUETOOTH\+\_\+\+COMMAND\+\_\+\+FORCE\+\_\+\+WATERING~\textquotesingle{}P\textquotesingle{}}

Makro in command indicating that user want to force watering of the plant regardless of soil moisture level. 

Definition at line 27 of file bluetooth\+\_\+interface.\+h.

\mbox{\Hypertarget{bluetooth__interface_8h_af814ff1fb37e1d4b7c3c04d877b799d2}\label{bluetooth__interface_8h_af814ff1fb37e1d4b7c3c04d877b799d2}} 
\index{bluetooth\_interface.h@{bluetooth\_interface.h}!BLUETOOTH\_COMMAND\_OK@{BLUETOOTH\_COMMAND\_OK}}
\index{BLUETOOTH\_COMMAND\_OK@{BLUETOOTH\_COMMAND\_OK}!bluetooth\_interface.h@{bluetooth\_interface.h}}
\doxysubsubsection{\texorpdfstring{BLUETOOTH\_COMMAND\_OK}{BLUETOOTH\_COMMAND\_OK}}
{\footnotesize\ttfamily \#define BLUETOOTH\+\_\+\+COMMAND\+\_\+\+OK~1}

Makro indicating successful execution of command. 

Definition at line 30 of file bluetooth\+\_\+interface.\+h.

\mbox{\Hypertarget{bluetooth__interface_8h_a238f817483a21aab491cfec0cf97465d}\label{bluetooth__interface_8h_a238f817483a21aab491cfec0cf97465d}} 
\index{bluetooth\_interface.h@{bluetooth\_interface.h}!BLUETOOTH\_COMMAND\_SEND\_DATA@{BLUETOOTH\_COMMAND\_SEND\_DATA}}
\index{BLUETOOTH\_COMMAND\_SEND\_DATA@{BLUETOOTH\_COMMAND\_SEND\_DATA}!bluetooth\_interface.h@{bluetooth\_interface.h}}
\doxysubsubsection{\texorpdfstring{BLUETOOTH\_COMMAND\_SEND\_DATA}{BLUETOOTH\_COMMAND\_SEND\_DATA}}
{\footnotesize\ttfamily \#define BLUETOOTH\+\_\+\+COMMAND\+\_\+\+SEND\+\_\+\+DATA~\textquotesingle{}S\textquotesingle{}}

Makro in command indicating that data was send. 

Definition at line 26 of file bluetooth\+\_\+interface.\+h.

\mbox{\Hypertarget{bluetooth__interface_8h_aef66ce2d643ae78c1ab253cb54309c07}\label{bluetooth__interface_8h_aef66ce2d643ae78c1ab253cb54309c07}} 
\index{bluetooth\_interface.h@{bluetooth\_interface.h}!BLUETOOTH\_COMMAND\_SEPARATOR@{BLUETOOTH\_COMMAND\_SEPARATOR}}
\index{BLUETOOTH\_COMMAND\_SEPARATOR@{BLUETOOTH\_COMMAND\_SEPARATOR}!bluetooth\_interface.h@{bluetooth\_interface.h}}
\doxysubsubsection{\texorpdfstring{BLUETOOTH\_COMMAND\_SEPARATOR}{BLUETOOTH\_COMMAND\_SEPARATOR}}
{\footnotesize\ttfamily \#define BLUETOOTH\+\_\+\+COMMAND\+\_\+\+SEPARATOR~\textquotesingle{}/\textquotesingle{}}

Separator used in command. 

Definition at line 28 of file bluetooth\+\_\+interface.\+h.

\mbox{\Hypertarget{bluetooth__interface_8h_a00018ef97fe87a259e77ca74d28ce3f1}\label{bluetooth__interface_8h_a00018ef97fe87a259e77ca74d28ce3f1}} 
\index{bluetooth\_interface.h@{bluetooth\_interface.h}!BLUETOOTH\_COMMAND\_SET\_AMOUNT@{BLUETOOTH\_COMMAND\_SET\_AMOUNT}}
\index{BLUETOOTH\_COMMAND\_SET\_AMOUNT@{BLUETOOTH\_COMMAND\_SET\_AMOUNT}!bluetooth\_interface.h@{bluetooth\_interface.h}}
\doxysubsubsection{\texorpdfstring{BLUETOOTH\_COMMAND\_SET\_AMOUNT}{BLUETOOTH\_COMMAND\_SET\_AMOUNT}}
{\footnotesize\ttfamily \#define BLUETOOTH\+\_\+\+COMMAND\+\_\+\+SET\+\_\+\+AMOUNT~\textquotesingle{}A\textquotesingle{}}

Makro in command indicating that user wants to change amount of water used to water the plant. 

Definition at line 25 of file bluetooth\+\_\+interface.\+h.

\mbox{\Hypertarget{bluetooth__interface_8h_aeeed2f3fbc9cf1e8555dc2fda473509a}\label{bluetooth__interface_8h_aeeed2f3fbc9cf1e8555dc2fda473509a}} 
\index{bluetooth\_interface.h@{bluetooth\_interface.h}!BLUETOOTH\_COMMAND\_SET\_FREQ@{BLUETOOTH\_COMMAND\_SET\_FREQ}}
\index{BLUETOOTH\_COMMAND\_SET\_FREQ@{BLUETOOTH\_COMMAND\_SET\_FREQ}!bluetooth\_interface.h@{bluetooth\_interface.h}}
\doxysubsubsection{\texorpdfstring{BLUETOOTH\_COMMAND\_SET\_FREQ}{BLUETOOTH\_COMMAND\_SET\_FREQ}}
{\footnotesize\ttfamily \#define BLUETOOTH\+\_\+\+COMMAND\+\_\+\+SET\+\_\+\+FREQ~\textquotesingle{}F\textquotesingle{}}

Makro in command indicating that user wants to change how often measurement should be performed. 

Definition at line 23 of file bluetooth\+\_\+interface.\+h.

\mbox{\Hypertarget{bluetooth__interface_8h_a8124d6861d899de89dd6ed62efd71f5b}\label{bluetooth__interface_8h_a8124d6861d899de89dd6ed62efd71f5b}} 
\index{bluetooth\_interface.h@{bluetooth\_interface.h}!BLUETOOTH\_COMMAND\_SET\_TIME@{BLUETOOTH\_COMMAND\_SET\_TIME}}
\index{BLUETOOTH\_COMMAND\_SET\_TIME@{BLUETOOTH\_COMMAND\_SET\_TIME}!bluetooth\_interface.h@{bluetooth\_interface.h}}
\doxysubsubsection{\texorpdfstring{BLUETOOTH\_COMMAND\_SET\_TIME}{BLUETOOTH\_COMMAND\_SET\_TIME}}
{\footnotesize\ttfamily \#define BLUETOOTH\+\_\+\+COMMAND\+\_\+\+SET\+\_\+\+TIME~\textquotesingle{}T\textquotesingle{}}

Makro in command indicating that user wants to change RTC time. 

Definition at line 22 of file bluetooth\+\_\+interface.\+h.



\doxysubsection{Function Documentation}
\mbox{\Hypertarget{bluetooth__interface_8h_a498f92a1519445a2fd94181a6b5e5a68}\label{bluetooth__interface_8h_a498f92a1519445a2fd94181a6b5e5a68}} 
\index{bluetooth\_interface.h@{bluetooth\_interface.h}!BLUETOOTH\_INTERFACE\_interpret\_command@{BLUETOOTH\_INTERFACE\_interpret\_command}}
\index{BLUETOOTH\_INTERFACE\_interpret\_command@{BLUETOOTH\_INTERFACE\_interpret\_command}!bluetooth\_interface.h@{bluetooth\_interface.h}}
\doxysubsubsection{\texorpdfstring{BLUETOOTH\_INTERFACE\_interpret\_command()}{BLUETOOTH\_INTERFACE\_interpret\_command()}}
{\footnotesize\ttfamily uint8\+\_\+t BLUETOOTH\+\_\+\+INTERFACE\+\_\+interpret\+\_\+command (\begin{DoxyParamCaption}\item[{char $\ast$}]{command,  }\item[{\mbox{\hyperlink{struct_water___pump___struct}{Water\+\_\+\+Pump\+\_\+\+Struct}} $\ast$}]{pump,  }\item[{\mbox{\hyperlink{struct_flags___struct}{Flags\+\_\+\+Struct}} $\ast$}]{flags,  }\item[{\mbox{\hyperlink{struct_a_l_a_r_m___r_t_c__struct}{ALARM\+\_\+\+RTC\+\_\+struct}} $\ast$}]{alarm\+\_\+struct }\end{DoxyParamCaption})}



Function used to interpret command according to rules of custom protocol. 


\begin{DoxyParams}{Parameters}
{\em command} & Pointer to command to be interpreted \\
\hline
{\em pump} & Pointer to water pump structure \\
\hline
{\em flags} & Pointer to flag structure \\
\hline
{\em alarm\+\_\+struct} & Pointer to RTC alarm structure \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
MAKROS\+: BLUETOOTH\+\_\+\+COMMAND\+\_\+\+OK if successful, BLUETOOTH\+\_\+\+COMMAND\+\_\+\+ERROR otherwise 
\end{DoxyReturn}


Definition at line 42 of file bluetooth\+\_\+interface.\+c.

\mbox{\Hypertarget{bluetooth__interface_8h_a46a15cdb1a7e826ba0ef0a12f7cd82df}\label{bluetooth__interface_8h_a46a15cdb1a7e826ba0ef0a12f7cd82df}} 
\index{bluetooth\_interface.h@{bluetooth\_interface.h}!BLUETOOTH\_INTERFACE\_send\_data@{BLUETOOTH\_INTERFACE\_send\_data}}
\index{BLUETOOTH\_INTERFACE\_send\_data@{BLUETOOTH\_INTERFACE\_send\_data}!bluetooth\_interface.h@{bluetooth\_interface.h}}
\doxysubsubsection{\texorpdfstring{BLUETOOTH\_INTERFACE\_send\_data()}{BLUETOOTH\_INTERFACE\_send\_data()}}
{\footnotesize\ttfamily uint8\+\_\+t BLUETOOTH\+\_\+\+INTERFACE\+\_\+send\+\_\+data (\begin{DoxyParamCaption}\item[{char $\ast$}]{buffer,  }\item[{\mbox{\hyperlink{struct_sensor___readings___struct}{Sensor\+\_\+\+Readings\+\_\+\+Struct}}}]{readings }\end{DoxyParamCaption})}



Prepares command with sensor data according to rules of protocol. 


\begin{DoxyParams}{Parameters}
{\em buffer} & Pointer to char array that will be filled with data -\/ should be at least 12 characters long \\
\hline
{\em readings} & struct with readings from sensors \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
MAKROS\+: BLUETOOTH\+\_\+\+COMMAND\+\_\+\+OK if successful, BLUETOOTH\+\_\+\+COMMAND\+\_\+\+ERROR otherwise 
\end{DoxyReturn}


Definition at line 162 of file bluetooth\+\_\+interface.\+c.

